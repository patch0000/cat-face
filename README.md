# cat-face
本のコードサンプルに基づいた猫顔認識のpython実装



技術評論社のデータサイエンティスト養成読本～機械学習入門編～
の４章「Pythonで画像認識にチャレンジ」のサンプルコードを
元に画像から猫の顔を検出する実装にチャレンジしたもの

・掲載コードは断片的なものに留まっている
・Python2.X系の書式になっている
・おそらくUnix環境前提
のため、適宜変更及び試行錯誤した。

2017年12月26日
現時点では下記の問題が未解決
（１）認識率が８５％程度。
本内では認識率は９５．９％超えとの事なのでどこかに何かの問題がある

（２）認識した猫顔部分を画像から切り出そうとすると明らかに間違った部分を切り出す。
画像処理ライブラリの使い方の問題なのか認識精度の問題なのか不明


２．動作手順メモ
１）Pythonの実行環境準備
Windows上にAnacondaをインストールし、エディターはSpyderで実行
気軽にPythonを触ってみるのにはこれが一番楽と思う

２）学習用猫画像の用意
猫顔の画像は元のページが消えてしまっているようだが、
下記にミラーサイトを作ってくれている人がいる、ありがたい。
https://archive.org/details/CAT_DATASET
右サイドメニューより
CAT_DATASET_01.zip 1.1G
CAT_DATASET_02.zip 910.0M
ダウンロード可能。

ファイル名のミスがあるようなので
CAT_00/00000003_019.jpg.cat
を00000003_015.jpg.cat
に要変更

３）猫が写っていないダミー画像の用意
本にはGoogleやFlickerから100枚程度を取ってきましょう、
と軽く書いてあるがこれが予想外に面倒。

画像自動取得のサンプルコードを公開してくれている方は沢山いるのだが、
検索エンジン側がAPI提供終了していたり、Python3に移植されていない
ライブラリを使用していたりでぴったりくるものが中々ない。

学習用画像データ入手はAI技術者共通の悩みのようなので
何か良い手があるのかもしれないが、当面は

shi3zさん（http://d.hatena.ne.jp/shi3z/20160309/1457480722）
が公開してくださったスクリプトを少しPython3用に変更して使った。

get_image.py

全画像を取ってくるのは時間がかかりすぎるから中断したし、
取得できない画像もあるが１０００程度の画像を用意するには十分。

なお、主に木や風景の画像を利用したが、これが私のスクリプトが
猫顔認識率が悪い原因の一つに思える。


４）画像の整形

crop_faces.py
crop_negatives.py

で画像サイズを扱いやすい形に整形する

５）特徴量の抜き出し
LBPで元に各画像から特徴量を抜き出す
get_feature.py

６）学習する
特徴量とそれが猫か否かのラベルを使いscikit-learnで学習する

７）検証
ダミーデータを使って精度を検出する
Accuracy.py

結果
Accuracy: 0.852232

本では
Accuracy: 0.959000
と書いてあったので１割も精度が低い。今のところ謎。


８）猫顔部分の検出
画像から猫顔部分を検出する
作ってはみたが明らかに動いていないのでまだ保留
 
